#!/bin/bash
#!/bin/bash
QTL="/mnt/disk2/vibanez/10_data-analysis/Fig5/results/01.1_QTLs_with_coordinates.tsv"
ANNO_DIR="/mnt/disk2/vibanez/05_DMR-processing/05.2_DMR-annotation/aa_annotation-data"
OUT_DIR="/mnt/disk2/vibanez/10_data-analysis/Fig5/results"

# Fix chromosome naming with leading zeros
awk 'NR > 1 {
  OFS = "\t";
  chr = $7;
  if (chr < 10) {
    chr = "0" chr;
  }
  print chr, $8, $9, $1, $2, $3, $4, $5, $6;
}' "${QTL}" |\
sortBed -i - > ${OUT_DIR}/tmp.bed
closestBed -D b -a ${OUT_DIR}/tmp.bed  -b ${ANNO_DIR}/allGeneNames-Function.bed -t all > ${OUT_DIR}/04.0_QTL_closest-gene.bed
intersectBed -a ${OUT_DIR}/tmp.bed  -b ${ANNO_DIR}/TE-wo-gene.bed  -wo |\
closestBed -D b -a -  -b ${ANNO_DIR}/allGeneNames-Function.bed -t all > ${OUT_DIR}/04.1_QTL-overTE_closest-gene.bed

awk '{print $15}' ${}04.0_QTL_closest-gene.bed | sed 's/Parent=gene://g' |head
